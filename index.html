<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <title id="site-title">Cold Room - Chat</title>
    <meta name="description" content="Cold Room - Premium Chat Platform">
    
    <link rel="icon" type="image/x-icon" id="site-favicon" href="https://j.top4top.io/p_3585vud691.jpg">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    
    <!-- Background Effects -->
    <div class="snowflakes" id="snowflakes"></div>
    <canvas id="snowman-canvas"></canvas>
    
    <!-- Background Music -->
    <audio id="login-music" loop autoplay></audio>
    <audio id="chat-music" loop></audio>
    <audio id="room-music" loop></audio>

    <!-- Login Screen -->
    <div id="login-screen" class="screen active">
        <div class="login-container">
            
            <!-- Logo -->
            <div class="site-logo">
                <img src="https://j.top4top.io/p_3585vud691.jpg" 
                     alt="Cold Room" 
                     class="logo-image"
                     id="main-logo">
                <div class="logo-text" id="main-title">Cold Room</div>
                <p class="logo-subtitle">Premium Chat Experience</p>
            </div>
            
            <div class="login-options">
                <!-- Login -->
                <div class="glass-card">
                    <h3>üîê Login</h3>
                    <div class="input-group">
                        <input type="text" id="login-username" placeholder="Username" 
                               maxlength="20" class="modern-input" autocomplete="username">
                        <input type="password" id="login-password" placeholder="Password" 
                               maxlength="100" class="modern-input" autocomplete="current-password">
                    </div>
                    <button class="modern-btn" onclick="login()">
                        <span class="btn-text">Enter Chat</span>
                    </button>
                </div>
                
                <!-- Register -->
                <div class="glass-card">
                    <h3>‚ú® Create Account</h3>
                    <div class="input-group">
                        <input type="text" id="register-username" placeholder="Username (3-20 chars)" 
                               maxlength="20" class="modern-input" autocomplete="username">
                        <input type="password" id="register-password" placeholder="Password (6+ chars)" 
                               maxlength="100" class="modern-input" autocomplete="new-password">
                        <input type="text" id="register-displayname" placeholder="Display Name (unique)" 
                               maxlength="30" class="modern-input">
                        <select id="register-gender" class="modern-input">
                            <option value="">Select Gender</option>
                            <option value="prince">ü§¥ Prince (Male)</option>
                            <option value="princess">üë∏ Princess (Female)</option>
                        </select>
                    </div>
                    <button class="modern-btn" onclick="register()">
                        <span class="btn-text">Create Account</span>
                    </button>
                </div>
            </div>

            <!-- Support Message -->
            <div class="glass-card support-section" id="support-section" style="display: none;">
                <h4>üì© Support Message</h4>
                <p style="margin-bottom: 1rem; opacity: 0.9;">
                    Send appeal to owner
                </p>
                <textarea id="support-message" class="modern-input" 
                          placeholder="Write your message..." 
                          maxlength="500" rows="4"></textarea>
                <button class="modern-btn" onclick="sendSupportMessage()">
                    Send to Owner
                </button>
            </div>

            <!-- Copyright -->
            <div class="copyright-notice">
                <strong>¬© 2025 Cold Room V3.0</strong><br>
                Owner: Cold Room King<br>
                <small>All rights reserved - Enhanced Edition</small>
            </div>
        </div>
    </div>

    <!-- Chat Screen -->
    <div id="chat-screen" class="screen">
        <div class="chat-container">
            
            <!-- Header -->
            <header class="chat-header">
                <div class="header-left">
                    <div class="header-logo">
                        <img src="https://j.top4top.io/p_3585vud691.jpg" 
                             alt="Cold Room" 
                             class="header-logo-image"
                             id="header-logo">
                        <div>
                            <h1 id="header-title">Cold Room</h1>
                            <div class="room-info" id="room-info">‚ùÑÔ∏è Global Room</div>
                        </div>
                    </div>
                    <div class="user-status" onclick="showProfileSettings()">
                        <div class="current-user-avatar-container">
                            <img src="" id="current-user-avatar-img" class="user-profile-img" style="display:none;">
                            <span class="current-user-avatar" id="current-user-avatar"></span>
                        </div>
                        <span id="current-user-name"></span>
                        <span id="user-badges"></span>
                    </div>
                </div>
                <div class="header-right">
                    <button class="modern-btn small" id="owner-panel-btn" 
                            style="display: none;" onclick="showOwnerPanel()">
                        üëë Owner Panel
                    </button>
                    <button class="modern-btn small" id="moderator-panel-btn" 
                            style="display: none;" onclick="showModeratorPanel()">
                        ‚≠ê Muted Users
                    </button>
                    <button class="modern-btn small" onclick="toggleRoomsList()">
                        üè† Rooms
                    </button>
                    <button class="modern-btn small" onclick="toggleUsersList()">
                        üë• Users
                    </button>
                    <button class="modern-btn small" onclick="showPrivateMessages()">
                        üí¨ Private
                    </button>
                    <button class="modern-btn small" onclick="logout()">
                        üö™ Logout
                    </button>
                </div>
            </header>
            
            <!-- Main Area -->
            <div class="chat-main">
                
                <!-- Rooms Sidebar -->
                <div id="rooms-sidebar" class="sidebar rooms-sidebar">
                    <div class="sidebar-header">
                        <h3>üè† Rooms</h3>
                        <div style="display:flex; gap:.5rem;">
                            <button class="modern-btn small" onclick="showCreateRoomModal()">‚ûï New</button>
                            <div class="sidebar-close-btn" onclick="toggleRoomsList()">‚úï</div>
                        </div>
                    </div>
                    <div id="rooms-list" class="rooms-list"></div>
                </div>

                <!-- Users Sidebar -->
                <div id="users-sidebar" class="sidebar users-sidebar">
                    <div class="sidebar-header">
                        <h3>üë• Online (<span id="users-count">0</span>)</h3>
                        <div class="sidebar-close-btn" onclick="toggleUsersList()">‚úï</div>
                    </div>
                    <div id="users-list" class="users-list"></div>
                </div>
                
                <!-- Messages Area -->
                <div class="chat-content">
                    <!-- Video Player - Minimized -->
                    <div id="video-minimized" class="video-minimized" style="display: none;" onclick="restoreVideo()">
                        ‚ñ∂Ô∏è
                    </div>

                    <!-- Video Player (YouTube/MP4/Instagram Reels) -->
                    <div id="video-player-container" class="video-player-container" style="display: none;">
                        <div class="video-header">
                            <button class="video-control-btn" onclick="toggleVideoControls()">‚öôÔ∏è</button>
                        </div>
                        <div id="video-content"></div>
                        <div class="video-controls" id="video-controls" style="display: none;">
                            <button class="modern-btn small" onclick="resizeVideo('small')">Small</button>
                            <button class="modern-btn small" onclick="resizeVideo('medium')">Medium</button>
                            <button class="modern-btn small" onclick="resizeVideo('large')">Large</button>
                            <button class="modern-btn small" onclick="minimizeVideo()">Minimize</button>
                            <button class="modern-btn small" onclick="closeVideo()">‚úï Close</button>
                        </div>
                    </div>

                    <div class="chat-messages" id="messages">
                        <div class="welcome-message glass-card">
                            <img src="https://j.top4top.io/p_3585vud691.jpg" 
                                 alt="Welcome" class="welcome-logo">
                            <h3>Welcome to Cold Room! ‚ùÑÔ∏è</h3>
                            <p>Start chatting with others</p>
                        </div>
                    </div>
                    
                    <!-- Send Tools -->
                    <div class="chat-tools">
                        <div class="tools-buttons" id="owner-tools" style="display: none;">
                            <button class="tool-btn" onclick="showImageUpload()" title="Send Image">
                                üñºÔ∏è
                            </button>
                            <button class="tool-btn" onclick="showVideoUpload()" title="Send Video">
                                üé•
                            </button>
                            <button class="tool-btn" onclick="showVideoModal()" title="Play Video">
                                üì∫
                            </button>
                            <button class="tool-btn" onclick="showRoomMediaSettings()" title="Room Media">
                                üé¨
                            </button>
                            <button class="tool-btn" onclick="togglePartyMode()" title="Party Mode">
                                üéâ
                            </button>
                        </div>
                        <form id="message-form" class="message-form">
                            <textarea id="message-input" class="message-input" 
                                    placeholder="Type your message... (500 chars max)" 
                                    maxlength="500" rows="1" disabled></textarea>
                            <button type="submit" class="modern-btn" disabled>
                                Send üöÄ
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Profile Settings Modal -->
    <div id="profile-settings-modal" class="modal">
        <div class="modal-content glass-card">
            <span class="modal-close" onclick="hideModal('profile-settings-modal')">&times;</span>
            <h2>üë§ Profile Settings</h2>
            <div class="modal-body">
                <div class="profile-preview">
                    <div class="profile-avatar-large">
                        <img src="" id="profile-preview-img" class="user-profile-img" style="display:none;">
                        <span id="profile-preview-emoji"></span>
                    </div>
                    <h3 id="profile-preview-name"></h3>
                </div>
                <div class="input-group">
                    <label>Profile Picture URL:</label>
                    <input type="text" id="profile-picture-url" class="modern-input" 
                           placeholder="https://... (JPG, PNG, GIF)">
                    <button class="modern-btn small" onclick="updateProfilePicture()">Update Picture</button>
                    <button class="modern-btn small" onclick="removeProfilePicture()">Remove Picture</button>
                </div>
                <div class="input-group">
                    <label>Change Display Name:</label>
                    <button class="modern-btn" onclick="changeName()">Change Name</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Room Media Settings Modal -->
    <div id="room-media-modal" class="modal">
        <div class="modal-content glass-card">
            <span class="modal-close" onclick="hideModal('room-media-modal')">&times;</span>
            <h2>üé¨ Room Media Settings</h2>
            <div class="modal-body">
                <h3>Current Room: <span id="current-room-name"></span></h3>
                
                <div class="setting-item">
                    <label>Room Video (YouTube/MP4/Reels):</label>
                    <input type="text" id="room-video-url" class="modern-input" 
                           placeholder="YouTube URL, MP4 URL, or Instagram Reel">
                    <button class="modern-btn small" onclick="updateRoomVideo()">Set Video</button>
                    <button class="modern-btn small" onclick="removeRoomVideo()">Remove Video</button>
                </div>
                
                <div class="setting-item">
                    <label>Room Music (MP3):</label>
                    <input type="text" id="room-music-url" class="modern-input" 
                           placeholder="https://...music.mp3">
                    <label>Volume:</label>
                    <input type="range" id="room-music-volume" min="0" max="1" step="0.1" value="0.5">
                    <button class="modern-btn small" onclick="updateRoomMusic()">Set Music</button>
                    <button class="modern-btn small" onclick="removeRoomMusic()">Remove Music</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Room Modal -->
    <div id="create-room-modal" class="modal">
        <div class="modal-content glass-card">
            <span class="modal-close" onclick="hideModal('create-room-modal')">&times;</span>
            <h2>üè† Create New Room</h2>
            <div class="modal-body">
                <input type="text" id="room-name-input" class="modern-input" 
                       placeholder="Room Name" maxlength="50">
                <textarea id="room-desc-input" class="modern-input" 
                          placeholder="Description (optional)" maxlength="200" rows="3"></textarea>
                <input type="password" id="room-pass-input" class="modern-input" 
                       placeholder="Password (optional)" maxlength="50">
                <button class="modern-btn" onclick="createRoom()">
                    Create Room
                </button>
            </div>
        </div>
    </div>

    <!-- Edit Room Modal -->
    <div id="edit-room-modal" class="modal">
        <div class="modal-content glass-card">
            <span class="modal-close" onclick="hideModal('edit-room-modal')">&times;</span>
            <h2>‚úèÔ∏è Edit Room</h2>
            <div class="modal-body">
                <input type="text" id="edit-room-name" class="modern-input" 
                       placeholder="Room Name" maxlength="50">
                <textarea id="edit-room-desc" class="modern-input" 
                          placeholder="Description" maxlength="200" rows="3"></textarea>
                <input type="password" id="edit-room-pass" class="modern-input" 
                       placeholder="New Password (leave empty to remove)" maxlength="50">
                <button class="modern-btn" onclick="saveRoomEdit()">
                    Save Changes
                </button>
            </div>
        </div>
    </div>

    <!-- Image Upload Modal -->
    <div id="image-upload-modal" class="modal">
        <div class="modal-content glass-card">
            <span class="modal-close" onclick="hideModal('image-upload-modal')">&times;</span>
            <h2>üñºÔ∏è Send Image</h2>
            <div class="modal-body">
                <input type="text" id="image-url-input" class="modern-input" 
                       placeholder="Image URL (https://...)">
                <button class="modern-btn" onclick="sendImageMessage()">
                    Send Image
                </button>
            </div>
        </div>
    </div>

    <!-- Video Upload Modal -->
    <div id="video-upload-modal" class="modal">
        <div class="modal-content glass-card">
            <span class="modal-close" onclick="hideModal('video-upload-modal')">&times;</span>
            <h2>üé• Send Video</h2>
            <div class="modal-body">
                <input type="text" id="video-url-input" class="modern-input" 
                       placeholder="Video URL (MP4 format)">
                <p style="margin: 0.5rem 0; font-size: 0.85rem; opacity: 0.8;">
                    ‚ö†Ô∏è Only MP4 video URLs supported
                </p>
                <button class="modern-btn" onclick="sendVideoMessage()">
                    Send Video
                </button>
            </div>
        </div>
    </div>

    <!-- Video Player Modal -->
    <div id="video-modal" class="modal">
        <div class="modal-content glass-card">
            <span class="modal-close" onclick="hideModal('video-modal')">&times;</span>
            <h2>üì∫ Play Video</h2>
            <div class="modal-body">
                <input type="text" id="video-play-input" class="modern-input" 
                       placeholder="YouTube URL, MP4 URL, or Instagram Reel URL">
                <p style="margin: 0.5rem 0; font-size: 0.85rem; opacity: 0.8;">
                    Supports: YouTube, MP4, Instagram Reels
                </p>
                <button class="modern-btn" onclick="startVideoWatch()">
                    Start Playing
                </button>
            </div>
        </div>
    </div>

    <!-- Private Messages Modal -->
    <div id="private-messages-modal" class="modal">
        <div class="modal-content glass-card large-modal">
            <span class="modal-close" onclick="hideModal('private-messages-modal')">&times;</span>
            <h2>üí¨ Private Messages</h2>
            <div class="modal-body private-chat">
                <div class="private-users-list" id="private-users-list"></div>
                <div class="private-messages-area">
                    <div class="private-header" id="private-header">
                        <span id="private-chat-name">Select a user</span>
                        <button class="modern-btn small" id="block-user-btn" style="display:none;" onclick="toggleBlockUser()">
                            üö´ Block
                        </button>
                    </div>
                    <div class="private-messages" id="private-messages"></div>
                    <div class="private-input-area" id="private-input-area">
                        <textarea id="private-message-input" class="modern-input" 
                                  placeholder="Type message..." maxlength="500" rows="2"></textarea>
                        <button class="modern-btn" onclick="sendPrivateMessage()">
                            Send
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Owner Panel Modal -->
    <div id="owner-panel-modal" class="modal">
        <div class="modal-content glass-card owner-modal">
            <span class="modal-close" onclick="hideModal('owner-panel-modal')">&times;</span>
            <h2>üëë Owner Control Panel</h2>
            <div class="modal-body">
                <div class="owner-tabs">
                    <button class="tab-btn active" onclick="switchOwnerTab('muted')">
                        üîá Muted
                    </button>
                    <button class="tab-btn" onclick="switchOwnerTab('banned')">
                        üö´ Banned
                    </button>
                    <button class="tab-btn" onclick="switchOwnerTab('support')">
                        üì© Support
                    </button>
                    <button class="tab-btn" onclick="switchOwnerTab('settings')">
                        ‚öôÔ∏è Settings
                    </button>
                </div>

                <div class="owner-content">
                    <!-- Muted Users -->
                    <div id="owner-muted" class="owner-tab-content active">
                        <div class="owner-actions">
                            <button class="modern-btn small" onclick="selectAllMuted()">Select All</button>
                            <button class="modern-btn small" onclick="unmuteSelected()">Unmute Selected</button>
                        </div>
                        <div id="muted-list" class="owner-list"></div>
                    </div>

                    <!-- Banned Users -->
                    <div id="owner-banned" class="owner-tab-content">
                        <div class="owner-actions">
                            <button class="modern-btn small" onclick="selectAllBanned()">Select All</button>
                            <button class="modern-btn small" onclick="unbanSelected()">Unban Selected</button>
                        </div>
                        <div id="banned-list" class="owner-list"></div>
                    </div>

                    <!-- Support Messages -->
                    <div id="owner-support" class="owner-tab-content">
                        <div id="support-messages-list" class="owner-list"></div>
                    </div>

                    <!-- Settings -->
                    <div id="owner-settings" class="owner-tab-content">
                        <div class="settings-grid">
                            <div class="setting-item">
                                <label>Site Logo URL:</label>
                                <input type="text" id="setting-logo" class="modern-input" 
                                       placeholder="https://...">
                                <button class="modern-btn small" onclick="updateLogo()">Update & Save</button>
                            </div>
                            <div class="setting-item">
                                <label>Site Title:</label>
                                <input type="text" id="setting-title" class="modern-input" 
                                       placeholder="Cold Room">
                                <button class="modern-btn small" onclick="updateTitle()">Update & Save</button>
                            </div>
                            <div class="setting-item">
                                <label>Background Color:</label>
                                <select id="setting-color" class="modern-input">
                                    <option value="blue">üîµ Blue (Ice)</option>
                                    <option value="black">‚ö´ Black</option>
                                    <option value="red">üî¥ Red Glass (Fire)</option>
                                </select>
                                <button class="modern-btn small" onclick="updateColor()">Update & Save</button>
                            </div>
                            <div class="setting-item">
                                <label>Login Page Music URL (MP3):</label>
                                <input type="text" id="setting-login-music" class="modern-input" 
                                       placeholder="https://...music.mp3">
                                <label>Volume:</label>
                                <input type="range" id="setting-login-volume" min="0" max="1" step="0.1" value="0.5">
                                <button class="modern-btn small" onclick="updateLoginMusic()">Update & Save</button>
                            </div>
                            <div class="setting-item">
                                <label>Global Chat Music URL (MP3):</label>
                                <input type="text" id="setting-chat-music" class="modern-input" 
                                       placeholder="https://...music.mp3">
                                <label>Volume:</label>
                                <input type="range" id="setting-chat-volume" min="0" max="1" step="0.1" value="0.5">
                                <button class="modern-btn small" onclick="updateChatMusic()">Update & Save</button>
                            </div>
                            <div class="setting-item">
                                <label>Clean a specific room:</label>
                                <select id="clean-room-select" class="modern-input"></select>
                                <div style="display:flex; gap:.5rem; margin-top:.5rem;">
                                    <button class="modern-btn small" onclick="cleanSelectedRoom()">üßπ Clean Selected Room</button>
                                    <button class="modern-btn small" onclick="cleanAllRooms()">üßπ Clean All Rooms</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Moderator Panel Modal -->
    <div id="moderator-panel-modal" class="modal">
        <div class="modal-content glass-card">
            <span class="modal-close" onclick="hideModal('moderator-panel-modal')">&times;</span>
            <h2>‚≠ê Moderator Panel - Muted Users</h2>
            <div class="modal-body">
                <div class="owner-actions">
                    <button class="modern-btn small" onclick="selectAllModMuted()">Select All</button>
                    <button class="modern-btn small" onclick="unmuteModSelected()">Unmute Selected</button>
                </div>
                <div id="mod-muted-list" class="owner-list"></div>
            </div>
        </div>
    </div>

    <!-- Actions Menu (Fixed Center) -->
    <div id="message-actions-menu" class="actions-menu glass-card" style="display: none;">
        <div class="actions-menu-header">‚öôÔ∏è Actions</div>
        <div id="message-actions-list"></div>
    </div>

    <!-- Confirm Modal -->
    <div id="confirm-modal" class="modal">
        <div class="modal-content glass-card" style="max-width: 400px;">
            <h2>‚ö†Ô∏è Confirm</h2>
            <p id="confirm-message" style="margin: 1.5rem 0; white-space: pre-line;"></p>
            <div style="display: flex; gap: 1rem;">
                <button class="modern-btn" onclick="confirmAction(true)" style="flex: 1;">
                    Yes
                </button>
                <button class="modern-btn" onclick="confirmAction(false)" style="flex: 1; background: #6b7280;">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://www.youtube.com/iframe_api"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="script.js"></script>
</body>
</html>
